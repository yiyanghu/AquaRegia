<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_51) on Wed Apr 09 14:55:48 CDT 2014 -->
<title>PaymentChannelClientConnection</title>
<meta name="date" content="2014-04-09">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="PaymentChannelClientConnection";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/PaymentChannelClientConnection.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClient.html" title="class in com.google.bitcoin.protocols.channels"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientState.html" title="class in com.google.bitcoin.protocols.channels"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/google/bitcoin/protocols/channels/PaymentChannelClientConnection.html" target="_top">Frames</a></li>
<li><a href="PaymentChannelClientConnection.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.google.bitcoin.protocols.channels</div>
<h2 title="Class PaymentChannelClientConnection" class="title">Class PaymentChannelClientConnection</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>com.google.bitcoin.protocols.channels.PaymentChannelClientConnection</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">PaymentChannelClientConnection</span>
extends java.lang.Object</pre>
<div class="block">A simple utility class that runs the micropayment protocol over a raw TCP socket using NIO, standalone.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientConnection.html#PaymentChannelClientConnection(java.net.InetSocketAddress, int, com.google.bitcoin.core.Wallet, com.google.bitcoin.core.ECKey, java.math.BigInteger, java.lang.String)">PaymentChannelClientConnection</a></strong>(java.net.InetSocketAddress&nbsp;server,
                              int&nbsp;timeoutSeconds,
                              <a href="../../../../../com/google/bitcoin/core/Wallet.html" title="class in com.google.bitcoin.core">Wallet</a>&nbsp;wallet,
                              <a href="../../../../../com/google/bitcoin/core/ECKey.html" title="class in com.google.bitcoin.core">ECKey</a>&nbsp;myKey,
                              java.math.BigInteger&nbsp;maxValue,
                              java.lang.String&nbsp;serverId)</code>
<div class="block">Attempts to open a new connection to and open a payment channel with the given host and port, blocking until the
 connection is open</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientConnection.html#disconnectWithoutSettlement()">disconnectWithoutSettlement</a></strong>()</code>
<div class="block">Disconnects the network connection but doesn't request the server to settle the channel first (literally just
 unplugs the network socket and marks the stored channel state as inactive).</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>com.google.common.util.concurrent.ListenableFuture&lt;<a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientConnection.html" title="class in com.google.bitcoin.protocols.channels">PaymentChannelClientConnection</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientConnection.html#getChannelOpenFuture()">getChannelOpenFuture</a></strong>()</code>
<div class="block">Gets a future which returns this when the channel is successfully opened, or throws an exception if there is
 an error before the channel has reached the open state.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>com.google.common.util.concurrent.ListenableFuture&lt;java.math.BigInteger&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientConnection.html#incrementPayment(java.math.BigInteger)">incrementPayment</a></strong>(java.math.BigInteger&nbsp;size)</code>
<div class="block">Increments the total value which we pay the server.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientConnection.html#settle()">settle</a></strong>()</code>
<div class="block">Closes the connection, notifying the server it should settle the channel by broadcasting the most recent payment
 transaction.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientState.html" title="class in com.google.bitcoin.protocols.channels">PaymentChannelClientState</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientConnection.html#state()">state</a></strong>()</code>
<div class="block">Gets the <a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientState.html" title="class in com.google.bitcoin.protocols.channels"><code>PaymentChannelClientState</code></a> object which stores the current state of the connection with the
 server.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="PaymentChannelClientConnection(java.net.InetSocketAddress, int, com.google.bitcoin.core.Wallet, com.google.bitcoin.core.ECKey, java.math.BigInteger, java.lang.String)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>PaymentChannelClientConnection</h4>
<pre>public&nbsp;PaymentChannelClientConnection(java.net.InetSocketAddress&nbsp;server,
                              int&nbsp;timeoutSeconds,
                              <a href="../../../../../com/google/bitcoin/core/Wallet.html" title="class in com.google.bitcoin.core">Wallet</a>&nbsp;wallet,
                              <a href="../../../../../com/google/bitcoin/core/ECKey.html" title="class in com.google.bitcoin.core">ECKey</a>&nbsp;myKey,
                              java.math.BigInteger&nbsp;maxValue,
                              java.lang.String&nbsp;serverId)
                               throws java.io.IOException,
                                      <a href="../../../../../com/google/bitcoin/protocols/channels/ValueOutOfRangeException.html" title="class in com.google.bitcoin.protocols.channels">ValueOutOfRangeException</a></pre>
<div class="block">Attempts to open a new connection to and open a payment channel with the given host and port, blocking until the
 connection is open</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>server</code> - The host/port pair where the server is listening.</dd><dd><code>timeoutSeconds</code> - The connection timeout and read timeout during initialization. This should be large enough
                       to accommodate ECDSA signature operations and network latency.</dd><dd><code>wallet</code> - The wallet which will be paid from, and where completed transactions will be committed.
               Must already have a <a href="../../../../../com/google/bitcoin/protocols/channels/StoredPaymentChannelClientStates.html" title="class in com.google.bitcoin.protocols.channels"><code>StoredPaymentChannelClientStates</code></a> object in its extensions set.</dd><dd><code>myKey</code> - A freshly generated keypair used for the multisig contract and refund output.</dd><dd><code>maxValue</code> - The maximum value this channel is allowed to request</dd><dd><code>serverId</code> - A unique ID which is used to attempt reopening of an existing channel.
                 This must be unique to the server, and, if your application is exposing payment channels to some
                 API, this should also probably encompass some caller UID to avoid applications opening channels
                 which were created by others.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if there's an issue using the network.</dd>
<dd><code><a href="../../../../../com/google/bitcoin/protocols/channels/ValueOutOfRangeException.html" title="class in com.google.bitcoin.protocols.channels">ValueOutOfRangeException</a></code> - if the balance of wallet is lower than maxValue.</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getChannelOpenFuture()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getChannelOpenFuture</h4>
<pre>public&nbsp;com.google.common.util.concurrent.ListenableFuture&lt;<a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientConnection.html" title="class in com.google.bitcoin.protocols.channels">PaymentChannelClientConnection</a>&gt;&nbsp;getChannelOpenFuture()</pre>
<div class="block"><p>Gets a future which returns this when the channel is successfully opened, or throws an exception if there is
 an error before the channel has reached the open state.</p>

 <p>After this future completes successfully, you may call
 <a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientConnection.html#incrementPayment(java.math.BigInteger)"><code>incrementPayment(java.math.BigInteger)</code></a> to begin paying the server.</p></div>
</li>
</ul>
<a name="incrementPayment(java.math.BigInteger)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>incrementPayment</h4>
<pre>public&nbsp;com.google.common.util.concurrent.ListenableFuture&lt;java.math.BigInteger&gt;&nbsp;incrementPayment(java.math.BigInteger&nbsp;size)
                                                                                          throws <a href="../../../../../com/google/bitcoin/protocols/channels/ValueOutOfRangeException.html" title="class in com.google.bitcoin.protocols.channels">ValueOutOfRangeException</a>,
                                                                                                 java.lang.IllegalStateException</pre>
<div class="block">Increments the total value which we pay the server.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>size</code> - How many satoshis to increment the payment by (note: not the new total).</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../com/google/bitcoin/protocols/channels/ValueOutOfRangeException.html" title="class in com.google.bitcoin.protocols.channels">ValueOutOfRangeException</a></code> - If the size is negative or would pay more than this channel's total value
                                  (<a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientConnection.html#state()"><code>state()</code></a>.getTotalValue())</dd>
<dd><code>java.lang.IllegalStateException</code> - If the channel has been closed or is not yet open
                               (see <a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientConnection.html#getChannelOpenFuture()"><code>getChannelOpenFuture()</code></a> for the second)</dd></dl>
</li>
</ul>
<a name="state()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>state</h4>
<pre>public&nbsp;<a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientState.html" title="class in com.google.bitcoin.protocols.channels">PaymentChannelClientState</a>&nbsp;state()</pre>
<div class="block"><p>Gets the <a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientState.html" title="class in com.google.bitcoin.protocols.channels"><code>PaymentChannelClientState</code></a> object which stores the current state of the connection with the
 server.</p>

 <p>Note that if you call any methods which update state directly the server will not be notified and channel
 initialization logic in the connection may fail unexpectedly.</p></div>
</li>
</ul>
<a name="settle()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>settle</h4>
<pre>public&nbsp;void&nbsp;settle()</pre>
<div class="block">Closes the connection, notifying the server it should settle the channel by broadcasting the most recent payment
 transaction.</div>
</li>
</ul>
<a name="disconnectWithoutSettlement()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>disconnectWithoutSettlement</h4>
<pre>public&nbsp;void&nbsp;disconnectWithoutSettlement()</pre>
<div class="block">Disconnects the network connection but doesn't request the server to settle the channel first (literally just
 unplugs the network socket and marks the stored channel state as inactive).</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/PaymentChannelClientConnection.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClient.html" title="class in com.google.bitcoin.protocols.channels"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../com/google/bitcoin/protocols/channels/PaymentChannelClientState.html" title="class in com.google.bitcoin.protocols.channels"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/google/bitcoin/protocols/channels/PaymentChannelClientConnection.html" target="_top">Frames</a></li>
<li><a href="PaymentChannelClientConnection.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
